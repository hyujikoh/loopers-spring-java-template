# 이커머스 서비스 요구사항 명세

## 개발 범위

### 포함 기능
- 상품 목록/상세 조회 및 브랜드 조회
- 상품 좋아요 등록/취소 (멱등성 보장)
- 주문 생성 및 결제 플로우 (재고 차감, 포인트 차감)

### 사용자 식별
- 모든 API는 `userId` 헤더를 통해 사용자를 식별
- 별도 인증/인가 로직 없음

---

## 📖 유저 시나리오

### 핵심 사용자 여정
```
1. 사용자가 이커머스 사이트에 접속
2. 다양한 브랜드의 상품들을 둘러보며 탐색
3. 마음에 드는 상품에 좋아요 등록
4. 여러 상품을 선택하여 한 번에 주문
5. 보유 포인트로 간편 결제 완료
```

### 주요 쇼핑 행동
- 상품 비교 후 구매
- 브랜드 기반 탐색
- 빠른 검색과 구매
---


## 시나리오 1 : 상품 발견과 탐색

### 유저 스토리
> **"다양한 상품을 찾아보고 싶다."**

**상황**: 사용자가 새로운 상품을 찾거나 특정 조건의 상품을 탐색하려는 경우
**핵심 니즈**: 
- 적당한 양의 상품을 압도되지 않게 보기 
- 개인 취향/예산에 맞는 상품 빠르게 탐색
- 인기/최신 상품 우선 확인

### 기능 요구사항

#### 1. 상품 목록 조회
- 페이지 단위로 상품을 조회할 수 있다 (20개 기본, 100개 최대)
- 무한 스크롤 또는 페이징 방식으로 추가 상품을 볼 수 있다
- 사용자 부담을 줄이는 적절한 표시 수량을 제공한다

#### 2. 필터링 및 정렬
- **브랜드 필터링**: 특정 브랜드의 상품만 볼 수 있다
- **정렬 옵션**: 
  - 최신순 (`latest`): 새로 등록된 상품부터
  - 가격 오름차순 (`price_asc`): 저렴한 상품부터
  - 좋아요순 (`likes_desc`): 인기 있는 상품부터

#### 3. 상품 상세 정보
- 구매 결정을 위한 기본 정보 제공
  - 상품명과 설명
  - 가격 정보 (정가, 할인가)
  - 재고 수량
  - 브랜드 정보 (브랜드명, 설명)
  - 출시일
- 좋아요 관련 정보
  - 해당 상품의 총 좋아요 수
  - 현재 조회 중인 사용자의 좋아요 여부

#### 4. 오류 처리
- 존재하지 않는 상품 조회 시 404 Not Found 응답
- 존재하지 않는 브랜드로 필터링 시 빈 목록 반환 (404 아님)

### 기술 요구사항
- **페이지네이션**: 기본 20개, 최대 100개
- **쿼리 파라미터**: `brandId`, `sort`, `page`, `size`
- **응답 데이터**: 상품 기본 정보, 브랜드 정보, 좋아요 수, 사용자 좋아요 상태
- **성능 목표**: 상품 목록 조회 < 500ms, 상품 상세 조회 < 300ms

---

## 시나리오 2 : 브랜드 중심 쇼핑

### 유저 스토리
> **"내가 좋아하는 브랜드의 다른 상품들도 보고 싶어요"**

**상황**: 특정 브랜드에 관심이 생겼거나 브랜드 충성도가 높은 사용자 (ex. 무신사 스탠다드)
**니즈**:
- 브랜드가 어떤 정체성을 가진지 알고 싶음
- 해당 브랜드의 다른 상품들도 함께 탐색하고 싶음

### 기능 요구사항

#### 1. 브랜드 조회
- 사용자는 브랜드의 기본 정보를 조회할 수 있다
- 브랜드명과 설명을 통해 브랜드에 대해 이해할 수 있다

#### 2. 브랜드 기반 상품 발견
- 특정 브랜드의 모든 상품을 모아서 볼 수 있다
- 브랜드 페이지에서 자연스럽게 상품 목록으로 이동 가능

#### 3. 오류 처리
- 존재하지 않는 브랜드 조회 시 404 Not Found 응답

### 기술 구현 요구사항
- 브랜드 정보 조회 API
- 브랜드별 상품 필터링 기능
- 브랜드명 중복 불가 정책

---

## 시나리오 3 : 관심 상품 관리 (좋아요)

### 유저 스토리
> **"마음에 드는 상품을 표시해두고 나중에 다시 보고 싶어요"**

**상황**: 탐색 중 마음에 드는 상품을 발견했지만 즉시 구매하지는 않는 경우
**니즈**:
- 관심 상품을 간단하게 표시하고 싶음
- 실수로 여러 번 눌러도 문제없이 동작했으면 함
- 나중에 관심 표시한 상품들을 모아서 보고 싶음
- 다른 사람들은 어떤 상품을 좋아하는지 궁금함

### 기능 요구사항

#### 1. 즉석 관심 표현
- 상품 보는 중에 클릭 한 번으로 좋아요 등록 가능
- 마음이 바뀌면 언제든 좋아요 취소 가능
- 실수로 여러 번 클릭해도 의도한 대로 동작 (멱등성)

#### 2. 개인 위시리스트
- 내가 좋아요한 상품들을 모아서 볼 수 있다
  - 좋아요한 시간 순으로 정렬 (최신순)
  - 각 상품의 현재 가격, 재고 상태 확인 가능
- 관심 상품 목록에서 바로 구매로 이어질 수 있다

#### 3. 상품 인기도 확인
- 상품 조회 시 전체 좋아요 수를 통해 인기도 확인
- 다른 사용자들의 관심도를 참고할 수 있음

#### 4. 오류 처리
- 존재하지 않는 상품에 좋아요 시도 시 404 Not Found 응답

### 기술 구현 요구사항
- 사용자당 상품별 좋아요 최대 1개
- 멱등성 보장: 중복 등록/취소 시 성공 응답
- 실시간 좋아요 수 집계 및 반영

---

## 시나리오 4 : 상품 주문

### 유저 스토리
> **"여러 상품을 한 번에 주문하고 포인트로 결제하고 싶다"**

**상황**: 탐색과 좋아요를 통해 구매할 상품들을 정했고 실제 주문하려는 상황
**니즈**:
- 장바구니처럼 여러 상품을 한 번에 주문하고 싶음
- 복잡한 결제 과정 없이 간단하게 구매하고 싶음
- 재고나 포인트 문제가 있으면 주문 전에 미리 알고 싶음
- 주문 후 내역을 확인하고 싶음

### 기능 요구사항

#### 1. 다중 상품 주문
- 여러 상품을 선택하고 각각 수량 지정 가능
- 총 주문 금액을 명확하게 확인 가능
- 주문 전 재고와 포인트 상황 검증

#### 2. 포인트 기반 간편 결제
- 사전 충전된 포인트로 결제 처리
- 카드 정보 입력 등 복잡한 과정 없음
- 포인트 부족 시 명확한 안내와 함께 주문 실패

#### 3. 안전한 주문 처리
- 재고 부족 시 주문 실패 및 명확한 메시지
- 일부 상품만 주문되는 상황 방지 (전체 성공 또는 전체 실패 기반 원자성 보장)
- 주문 완료 시 재고와 포인트 동시 차감

#### 4. 주문 이력 관리
- 내 주문 목록 조회 가능
- 주문별 상세 내역 확인 가능
- 주문 상태 추적 가능

#### 5. 오류 처리
- 존재하지 않는 상품으로 주문 시도 시 404 Not Found 응답
- 존재하지 않는 주문 조회 시 404 Not Found 응답
- 존재하지 않는 사용자의 주문 목록 조회 시 404 Not Found 응답
- 재고 부족 시 400 Bad Request 응답 (명확한 오류 메시지 포함)
- 포인트 부족 시 400 Bad Request 응답 (필요/보유 포인트 정보 포함)
- 동시 주문으로 인한 재고 부족 시 409 Conflict 응답
- 이미 취소된 주문을 다시 취소 시도 시 400 Bad Request 응답

### 기술 구현 요구사항
- 트랜잭션: 재고 차감, 포인트 차감, 주문 생성의 원자성
- 동시성 제어: 동시 주문 시 정확한 재고 관리
- 주문 상태: PENDING, CONFIRMED, CANCELLED
- 외부 시스템 연동 (Mock 처리)
- **오류 응답 정책**: 404 (리소스 없음), 400 (비즈니스 규칙 위반), 409 (동시성 충돌)

---